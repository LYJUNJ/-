<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>医生排班管理 - 智慧医药系统</title>
    <link rel="shortcut icon" type="image/x-icon" href="assets/images/cropped-favicon-32x32.png"/>
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/style.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/plugin.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/dashboard.css" rel="stylesheet" type="text/css"/>
    <link href="assets/fonts/flaticon.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/icons.css" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="assets/fonts/line-icons.css" type="text/css"/>
    <link rel="stylesheet" href="common/font-awesome/css/font-awesome.min.css">
</head>
<body>
<div id="preloader"><div id="status"></div></div>
<div th:replace="common/common-bar::#header"></div>
<div id="dashboard">
    <div class="container">
        <div class="dashboard-main">
            <div class="row">
                <div class="col-lg-3 col-md-12 col-sm-12 col-xs-12">
                    <div th:replace="common/common-bar::#dashboard-sidebar(cur='schedule')"></div>
                </div>
                <div class="col-lg-9 col-md-12 col-sm-12 col-xs-12">
                    <div class="dashboard-content">
                        <div class="row mb-4">
                            <div class="col-lg-12 col-md-12 col-xs-12">
                                <div class="dashboard-list-box with-icons">
                                    <div class="dashboard-title d-flex justify-content-between align-items-center">
                                        <div>
                                            <h4 class="mb-0">医生排班</h4>
                                            <p class="mb-0">共收集 [[${total}]] 条排班信息。你可以继续<a href="/add-schedule">新增排班</a>。</p>
                                        </div>
                                    </div>
                                    <div class="table-responsive table-desi">
                                        <table class="basic-table table table-hover">
                                            <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>医生姓名</th>
                                                <th>科室</th>
                                                <th>就诊数量</th>
                                                <th>周几</th>
                                                <th>操作</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr th:each="schedule, stat : ${schedules}">
                                                <td th:text="${schedule.id}"></td>
                                                <td th:text="${schedule.doctorName}"></td>
                                                <td th:text="${schedule.departmentName}"></td>
                                                <td th:text="${schedule.visitCount}"></td>
                                                <td th:text="${schedule.weekDay}"></td>
                                                <td>
                                                    <a th:href="@{'/edit-schedule/' + ${schedule.id}}"><i class="fa fa-pencil-square-o text-primary" aria-hidden="true"></i></a>
                                                    <a th:onclick="deleteSchedule([[${schedule.id}]])" href="javascript:void(0)"><i class="fa fa-trash-o text-danger" aria-hidden="true"></i></a>
                                                </td>
                                            </tr>
                                            <tr th:if="${#lists.isEmpty(schedules)}">
                                                <td colspan="6" class="text-center">暂无数据</td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <!-- 分页可参考all-department.html的实现 -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div th:replace="common/common-bar::#back"></div>
<div th:replace="common/common-bar::#footer"></div>
<div th:replace="common/common-bar::#search"></div>
<div th:replace="common/common-bar::#back-to-top"></div>
<script src="assets/js/jquery-3.5.1.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/plugin.js"></script>
<script src="assets/js/main.js"></script>
<script src="assets/js/custom-nav.js"></script>
<script src="assets/js/jpanelmenu.min.js"></script>
<script src="assets/js/dashboard-custom.js"></script>
<script src="common/utils/reg.js"></script>
<script src="common/layer/layer.js"></script>
<script src="common/custom.js"></script>
<script>
function deleteSchedule(id) {
    if (!confirm('确定要删除该排班吗？')) return;
    $.ajax({
        url: '/delete-schedule',
        type: 'POST',
        data: {id: id},
        success: function(res) {
            if (res === 'success') {
                location.reload();
            } else {
                layer.msg(res.msg || '删除失败');
            }
        }
    });
}
</script>
</body>
</html>
